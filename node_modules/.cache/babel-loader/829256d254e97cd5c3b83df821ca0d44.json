{"ast":null,"code":"var window = require('global/window');\n\nvar elementUtils = require('../utils/element');\n\nvar assign = require('../utils/lodash').assign;\n\nvar disposable = require('../utils/misc').disposable;\n\nfunction defaultExtendClickData(event, data) {\n  return data;\n}\n\nfunction configure() {\n  this._clickTrackingInstalled = false;\n}\n\nfunction trackClicks(trackClicksOptions) {\n  if (this._clickTrackingInstalled) return;\n  var instance = this;\n  var options = assign({\n    element: window.document,\n    extendClickData: defaultExtendClickData,\n    ignoreAttribute: 'td-ignore',\n    tableName: 'clicks'\n  }, trackClicksOptions);\n  var treeHasIgnoreAttribute = elementUtils.createTreeHasIgnoreAttribute(options.ignoreAttribute);\n  var removeClickTracker = elementUtils.addEventListener(options.element, 'click', clickTracker);\n  instance._clickTrackingInstalled = true;\n  return disposable(function () {\n    removeClickTracker();\n    instance._clickTrackingInstalled = false;\n  });\n\n  function clickTracker(e) {\n    var target = elementUtils.findElement(elementUtils.getEventTarget(e));\n\n    if (target && !treeHasIgnoreAttribute(target)) {\n      var elementData = elementUtils.getElementData(target);\n      var data = options.extendClickData(e, elementData);\n\n      if (data) {\n        instance.trackEvent(options.tableName, data);\n      }\n    }\n  }\n}\n\nmodule.exports = {\n  configure: configure,\n  trackClicks: trackClicks\n};","map":null,"metadata":{},"sourceType":"script"}