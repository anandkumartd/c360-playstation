{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nexports.formatNumber = formatNumber;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactSankey = require('../helpers/react-sankey');\n\nrequire('./react-sankey.component.css');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar defaultChartConfig = {\n  padding: {\n    top: 10,\n    right: 0,\n    bottom: 10,\n    left: 0\n  },\n  node: {\n    width: 150,\n    maxHeight: 150,\n    minHeight: 55,\n    rectMinHeight: 5,\n    paddingBottom: 40\n  },\n  link: {\n    width: 100\n  }\n}; // Example 3985763 -> 3,985,763\n\nfunction formatNumber(value) {\n  return value.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,');\n}\n\nvar ReactSankey = function (_React$Component) {\n  _inherits(ReactSankey, _React$Component);\n\n  function ReactSankey() {\n    _classCallCheck(this, ReactSankey);\n\n    return _possibleConstructorReturn(this, (ReactSankey.__proto__ || Object.getPrototypeOf(ReactSankey)).apply(this, arguments));\n  }\n\n  _createClass(ReactSankey, [{\n    key: 'renderNodeArrows',\n    value: function renderNodeArrows(node) {\n      var chartConfig = this.getConfig();\n      var className = this.props.arrowClass ? this.props.arrowClass : 'qb-node-arrow';\n\n      if (node.isFirstChild && node.isLastChild) {\n        return _react2.default.createElement('path', {\n          className: className,\n          d: '\\n            M' + -10 + ' ' + 20.5 + ' h-' + chartConfig.link.width + '\\n            M' + -10 + ' ' + 20.5 + ' l' + -4 + ' ' + -4 + '\\n            M' + -10 + ' ' + 20.5 + ' l' + -4 + ' ' + 4 + '\\n          '\n        });\n      }\n\n      if (node.isFirstChild) {\n        return _react2.default.createElement('path', {\n          className: className,\n          d: '\\n            M' + -10 + ' ' + 20.5 + ' h-' + chartConfig.link.width + '\\n            M' + -10 + ' ' + 20.5 + ' l' + -4 + ' ' + -4 + '\\n            M' + -10 + ' ' + 20.5 + ' l' + -4 + ' ' + 4 + '\\n            M-' + (parseInt(chartConfig.link.width / 3, 10) - 0.5) + ' ' + 20.5 + ' v' + ((0, _reactSankey.getNodeBranchHeight)(chartConfig, node) + chartConfig.node.paddingBottom) + '\\n          '\n        });\n      }\n\n      if (node.isLastChild) {\n        return _react2.default.createElement('path', {\n          className: className,\n          d: '\\n            M' + -10 + ' ' + 20.5 + ' h-' + (parseInt(chartConfig.link.width / 3, 10) - 10) + '\\n            M' + -10 + ' ' + 20.5 + ' l' + -4 + ' ' + -4 + '\\n            M' + -10 + ' ' + 20.5 + ' l' + -4 + ' ' + 4 + '\\n          '\n        });\n      }\n\n      return _react2.default.createElement('path', {\n        className: className,\n        d: '\\n          M' + -10 + ' ' + 20.5 + ' h-' + (parseInt(chartConfig.link.width / 3, 10) - 10) + '\\n          M' + -10 + ' ' + 20.5 + ' l' + -4 + ' ' + -4 + '\\n          M' + -10 + ' ' + 20.5 + ' l' + -4 + ' ' + 4 + '\\n          M-' + (parseInt(chartConfig.link.width / 3, 10) - 0.5) + ' ' + 20.5 + ' v' + ((0, _reactSankey.getNodeBranchHeight)(chartConfig, node) + chartConfig.node.paddingBottom) + '\\n        '\n      });\n    }\n  }, {\n    key: 'renderPath',\n    value: function renderPath(path) {\n      var className = this.props.linkClass ? this.props.linkClass : 'qb-link';\n      return _react2.default.createElement('path', {\n        key: path.id,\n        className: className,\n        d: path.d\n      });\n    }\n  }, {\n    key: 'renderNode',\n    value: function renderNode(chartConfig, node) {\n      if (this.props.customNode) {\n        return this.props.customNode(chartConfig, node);\n      }\n\n      return _react2.default.createElement('g', {\n        key: node.id,\n        className: 'qb-node',\n        transform: 'translate(' + node.x + ',' + node.y + ')'\n      }, _react2.default.createElement('rect', {\n        height: node.height,\n        width: chartConfig.node.width\n      }), _react2.default.createElement('text', {\n        x: 30,\n        y: 24\n      }, '' + node.title), _react2.default.createElement('text', {\n        className: 'qb-value',\n        x: 30,\n        y: 50\n      }, '' + formatNumber(node.value)));\n    }\n  }, {\n    key: 'renderArrow',\n    value: function renderArrow(node) {\n      if (node.id == this.props.rootID) {\n        return null;\n      }\n\n      return _react2.default.createElement('g', {\n        key: node.id,\n        className: 'qb-arrow',\n        transform: 'translate(' + node.x + ',' + node.y + ')'\n      }, this.renderNodeArrows(node));\n    }\n  }, {\n    key: 'getConfig',\n    value: function getConfig() {\n      return this.props.chartConfig ? this.props.chartConfig : defaultChartConfig;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var chartConfig = this.getConfig();\n      var tree = (0, _reactSankey.createTree)(chartConfig, this.props.rootID, this.props.links, this.props.nodes, this.props.rootID);\n      var nodes = (0, _reactSankey.getTreeNodes)(chartConfig, tree);\n      var pathes = (0, _reactSankey.getTreePaths)(chartConfig, this.props.links, nodes);\n      var maxTreeLevel = nodes.reduce(function (level, node) {\n        return Math.max(level, node.level);\n      }, 0);\n      var chartWidth = (maxTreeLevel + 1) * chartConfig.node.width + maxTreeLevel * chartConfig.link.width;\n      var chartHeight = nodes.reduce(function (height, node) {\n        // find total height of node children\n        var currentChildrenHeight = node.children.reduce(function (childrenHeight, child) {\n          return childrenHeight + (0, _reactSankey.getNodeBranchHeight)(chartConfig, child) + chartConfig.node.paddingBottom;\n        }, 0); // exclude bottom padding of last child and add parent y position\n\n        currentChildrenHeight = currentChildrenHeight - chartConfig.node.paddingBottom + node.y;\n        return Math.max(currentChildrenHeight, height);\n      }, 0);\n      var _chartConfig$padding = chartConfig.padding,\n          left = _chartConfig$padding.left,\n          right = _chartConfig$padding.right,\n          top = _chartConfig$padding.top,\n          bottom = _chartConfig$padding.bottom;\n      return _react2.default.createElement('svg', {\n        width: chartWidth + left + right,\n        height: chartHeight + top + bottom\n      }, _react2.default.createElement('g', {\n        transform: 'translate(' + left + ',' + top + ')'\n      }, pathes.map(function (path) {\n        return _this2.renderPath(path);\n      }), nodes.map(function (node) {\n        return _this2.renderNode(chartConfig, node);\n      }), chartConfig.link.width >= 60 && this.props.hasArrows && nodes.map(function (node) {\n        return _this2.renderArrow(node);\n      }), _react2.default.createElement('linearGradient', {\n        id: 'linear-gradient'\n      }, _react2.default.createElement('stop', {\n        offset: '0%',\n        stopColor: '#D1DFE0'\n      }), _react2.default.createElement('stop', {\n        offset: '100%',\n        stopColor: '#D5EDEF'\n      }))));\n    }\n  }]);\n\n  return ReactSankey;\n}(_react2.default.Component);\n\nReactSankey.propTypes = {};\nexports.default = ReactSankey;","map":null,"metadata":{},"sourceType":"script"}